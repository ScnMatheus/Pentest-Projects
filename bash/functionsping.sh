#!/bin/bash

reset_variables() {
    domain=""
    ip_address=""
}

while true; do
    echo "Selecione uma opção:"
    echo "1. URLFinder"
    echo "2. Teste de Ping"
    echo "3. Resetar Variáveis"
    echo "4. Sair"
    
    read -p "Opção: " option
    
    case $option in
        1)
            echo "Digite o domínio alvo:"
            read domain
            
            echo -e "\n===================================="
            echo -e "\n [+] Resolvendo URLS em: $domain"
            echo -e "\n===================================="
            
            wget -q "$domain"
            
            echo -e "\n [+] Concluído: salvando os resultados em: $domain.ip.txt"
            
            cat index.html | egrep "href" | cut -d "/" -f 3 | grep "\." | cut -d '"' -f 1 | grep -v "<" | grep -v "li" >> $domain.ip.txt
            
            lines=$(wc -l < $domain.ip.txt)
            echo "$lines totais no arquivo"
            
            for ((line=1; line<=$lines; line++)); do
                ip=$(sed -n "$line"p $domain.ip.txt)
                domain_result=$(host $ip | grep "has address" | awk '{print $4}')
                echo "$ip -> $domain_result" >> $domain.ip.txt.temp
            done
            
            sort -u $domain.ip.txt.temp > $domain.ip.txt.sorted
            rm $domain.ip.txt.temp
            ;;
        2)
            echo "Digite o endereço IP para o teste de ping:"
            read ip_address
            ping -c 4 $ip_address
            ;;
        3)
            echo "Resetando variáveis."
            reset_variables
            ;;
        4)
            echo "Saindo do programa."
            exit 0
            ;;
        *)
            echo "Opção inválida. Tente novamente."
            ;;
    esac
done
