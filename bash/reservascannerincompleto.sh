#!/bin/bash

# Solicita o endereço IP sem o último octeto
echo "Para iniciar, nos informe o endereço IP sem o último octeto:"
read host

# Solicita o modo de varredura
echo "Varredura automática ou varredura manual? [1/2]"
read opcao

# Verifica o modo de varredura
if [ "$opcao" == "1" ]; then
    # Varredura automática

    # Solicita a porta a ser varrida
    echo "Qual a porta que você deseja varrer?"
    read porta

    # Solicita o tipo de comunicação
    echo "Escolha o tipo de comunicação:"
    echo "1. ICMP Echo Request (-s)"
    echo "2. TCP SYN (-S)"
    echo "3. TCP XMAS (-X)"
    echo "4. TCP FIN (-F)"
    echo "5. TCP NULL (-N)"
    echo "6. UDP (-U)"
    echo "7. UDP ACK (-W)"
    echo "8. UDP PUSH (-P)"
    echo "9. UDP ICMP (-D)"
    echo "10. RAW IP (-R)"
    echo "11. Traceroute (-T)"
    echo "12. Sair"

    # Lê a entrada do usuário
    read -p "Opção: " opcao

    # Verifica a opção escolhida pelo usuário
    if [ "$opcao" == "1" ]; then
        # Envia um pacote ICMP Echo Request
        comunicacao= -s -c 1
    elif [ "$opcao" == "2" ]; then
        # Envia um pacote TCP SYN
        comunicacao= -S -c 1
    elif [ "$opcao" == "3" ]; then
        # Envia um pacote TCP XMAS
        comunicacao= -X -c 1
    elif [ "$opcao" == "4" ]; then
        # Envia um pacote TCP FIN
        comunicacao= -F -c 1
    elif [ "$opcao" == "5" ]; then
        # Envia um pacote TCP NULL
        comunicacao= -N -c 1
    elif [ "$opcao" == "6" ]; then
        # Envia um pacote UDP
        comunicacao= -U -c 1
    elif [ "$opcao" == "7" ]; then
        # Envia um pacote UDP ACK
        comunicacao= -W -c 1
    elif [ "$opcao" == "8" ]; then
        # Envia um pacote UDP PUSH
        comunicacao= -P -c 1
    elif [ "$opcao" == "9" ]; then
        # Envia um pacote UDP ICMP
        comunicacao= -D -c 1
    elif [ "$opcao" == "10" ]; then
        # Envia um pacote RAW IP
        comunicacao= -R -c 1
    elif [ "$opcao" == "11" ]; then
        # Envia um pacote Traceroute
        comunicacao= -T -c 1
    elif [ "$opcao" == "12" ]; then
        # Sai do programa
        exit
    else
        # Opção inválida
        echo "Opção inválida."
    fi

    # Varre o intervalo de IPs de 1 a 254
    for ip in $(seq 1 254); do
        hping3 "$comunicacao" "$porta" "$host.$ip" | cut -d " " -f 2 | sed 's/.$//'
    done
else
    # Varredura manual

    # Solicita a quantidade de dispositivos a serem varridos
    echo "Quantos dispositivos deseja varrer?"
    read disps

    # Varre os IPs especificados pelo usuário
    for ip in $(seq 1 $disps); do
        hping3 "$comunicacao" "$porta" "$host.$ip"
    done
fi
